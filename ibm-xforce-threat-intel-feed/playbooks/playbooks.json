{
  "type": "workflow_collections",
  "data": [
    {
      "@type": "WorkflowCollection",
      "name": "Sample - IBM X-Force Threat Intelligence Feed - 2.0.0",
      "description": "Sample playbooks for \"IBM X-Force Threat Intelligence Feed\" connector. If you are planning to use any of the sample playbooks in your environment, ensure that you clone those playbooks and move them to a different collection, since the sample playbook collection gets deleted during connector upgrade and delete.",
      "visible": true,
      "image": "/api/3/images/87db8629-4188-4290-af67-d88146ca7c4d",
      "uuid": "8af111af-220b-4492-82e4-4c6cdce6f667",
      "id": 16,
      "createUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
      "createDate": 1641280805.631969,
      "modifyUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
      "modifyDate": 1641280805.631969,
      "recordTags": [],
      "deletedAt": null,
      "workflows": [
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "IBM X-Force Threat Intel > Ingest",
          "aliasName": null,
          "tag": null,
          "description": "Fetch Collections from IBM X-Force Threat Intelligence Feed",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1640954873,
          "collection": "/api/3/workflow_collections/8af111af-220b-4492-82e4-4c6cdce6f667",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/ec146c95-fca3-4c9f-872d-29607e374240",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "step_variables": {
                  "input": {
                    "params": []
                  }
                }
              },
              "status": null,
              "top": "40",
              "left": "120",
              "stepType": "/api/3/workflow_step_types/b348f017-9a94-471f-87f8-ce88b6a7ad62",
              "uuid": "ec146c95-fca3-4c9f-872d-29607e374240",
              "id": 293
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Macro Value",
              "description": null,
              "arguments": {
                "params": {
                  "iri": "/api/wf/api/dynamic-variable/?name={{vars.pullTimeMacro}}",
                  "body": "",
                  "method": "GET"
                },
                "version": "3.1.2",
                "connector": "cyops_utilities",
                "operation": "make_cyops_request",
                "operationTitle": "FSR: Make FortiSOAR API Call",
                "step_variables": []
              },
              "status": null,
              "top": "280",
              "left": "120",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "85fe8d2b-414e-49bf-b3a8-93ad9633aed9",
              "id": 294
            },
            {
              "@type": "WorkflowStep",
              "name": "Get All Collections",
              "description": null,
              "arguments": {
                "name": "IBM X-Force Threat Intelligence Feed",
                "config": "d50acc3c-70e5-4fb2-ac8e-1fb801d75b8b",
                "params": [],
                "version": "1.0.0",
                "connector": "ibm-xforce-threat-intel-feed",
                "operation": "get_collections",
                "operationTitle": "Get Collections",
                "pickFromTenant": false,
                "step_variables": {
                  "collections": "{{vars.result.data.collections | json_query(\"[?contains(id, '-')].id\")}}"
                }
              },
              "status": null,
              "top": "520",
              "left": "120",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "97a0486c-1687-42a7-a2b4-69ba28aa7e09",
              "id": 295
            },
            {
              "@type": "WorkflowStep",
              "name": "Extract Value from Response",
              "description": null,
              "arguments": {
                "lastPullTime": "{% if (vars.steps.Get_Macro_Value.data[\"hydra:member\"] | length) > 0%}{{vars.steps.Get_Macro_Value.data[\"hydra:member\"][0].value }}{% else %}{{arrow.get((arrow.utcnow().int_timestamp  | int | abs)).shift(days=-30).format('YYYY-MM-DDTHH:mm:ss.SSS')+'Z'}}{% endif %}"
              },
              "status": null,
              "top": "400",
              "left": "120",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "b28d1f36-735e-4dc0-9638-c0dd514d8db4",
              "id": 296
            },
            {
              "@type": "WorkflowStep",
              "name": "Update Pull Time",
              "description": null,
              "arguments": {
                "params": {
                  "macro": "{{vars.pullTimeMacro}}",
                  "value": "{{vars.fetchTime}}"
                },
                "version": "3.1.2",
                "connector": "cyops_utilities",
                "operation": "updatemacro",
                "operationTitle": "CyOPs: Update Macro",
                "step_variables": []
              },
              "status": null,
              "top": "760",
              "left": "120",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "02631bdf-5f8d-4fc4-b192-602356e202cc",
              "id": 297
            },
            {
              "@type": "WorkflowStep",
              "name": "Fetch and Create",
              "description": null,
              "arguments": {
                "name": "IBM X-Force Threat Intelligence Feed",
                "config": "8b31bf63-c9d2-4085-a3c3-8c17d029a87a",
                "params": {
                  "added_after": "",
                  "output_mode": "Create as Feed Records in FortiSOAR",
                  "added_before": "",
                  "collectionID": "{{ vars.item.id }}",
                  "create_pb_id": "6528e062-5a91-496b-acce-433f67726367"
                },
                "version": "2.0.0",
                "for_each": {
                  "item": "{{vars.steps.Get_All_Collections.data.collections}}",
                  "parallel": false,
                  "condition": ""
                },
                "connector": "ibm-xforce-threat-intel-feed",
                "operation": "get_objects_by_collection_id",
                "ignore_errors": false,
                "operationTitle": "Get Objects By Collection ID",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "640",
              "left": "120",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "966a046a-15d7-4c23-8764-9c2af2983c70",
              "id": 298
            },
            {
              "@type": "WorkflowStep",
              "name": "Configuration",
              "description": null,
              "arguments": {
                "fetchTime": "{{arrow.get((arrow.utcnow().int_timestamp  | int | abs)).format('YYYY-MM-DDTHH:mm:ss.SSS')+'Z'}}",
                "pullTimeMacro": "IBMXForceFeedLastPullTime_{{vars['audit_info']['cyops_playbook_iri'].split('/')[-1].replace('-','_')}}"
              },
              "status": null,
              "top": "160",
              "left": "120",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "5e4364ef-9d7d-4808-a478-66f5ab44b4ab",
              "id": 292
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Extract Value from Response -> Get All Collections",
              "targetStep": "/api/3/workflow_steps/97a0486c-1687-42a7-a2b4-69ba28aa7e09",
              "sourceStep": "/api/3/workflow_steps/b28d1f36-735e-4dc0-9638-c0dd514d8db4",
              "label": null,
              "isExecuted": false,
              "uuid": "15043fe0-84aa-47ed-bac9-fef08f0caf55"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Configuration",
              "targetStep": "/api/3/workflow_steps/5e4364ef-9d7d-4808-a478-66f5ab44b4ab",
              "sourceStep": "/api/3/workflow_steps/ec146c95-fca3-4c9f-872d-29607e374240",
              "label": null,
              "isExecuted": false,
              "uuid": "578056b6-b296-4b5a-8f92-12a47ae14243"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Configuration -> Get Macro Value",
              "targetStep": "/api/3/workflow_steps/85fe8d2b-414e-49bf-b3a8-93ad9633aed9",
              "sourceStep": "/api/3/workflow_steps/5e4364ef-9d7d-4808-a478-66f5ab44b4ab",
              "label": null,
              "isExecuted": false,
              "uuid": "f260ec9e-fb07-4720-840d-b05c2cb48d6a"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get Macro Value -> Extract Value from Response",
              "targetStep": "/api/3/workflow_steps/b28d1f36-735e-4dc0-9638-c0dd514d8db4",
              "sourceStep": "/api/3/workflow_steps/85fe8d2b-414e-49bf-b3a8-93ad9633aed9",
              "label": null,
              "isExecuted": false,
              "uuid": "f69dc3c3-eb0f-46ee-8bee-8b28e56c20b5"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get All Collections -> Fetch and Create",
              "targetStep": "/api/3/workflow_steps/966a046a-15d7-4c23-8764-9c2af2983c70",
              "sourceStep": "/api/3/workflow_steps/97a0486c-1687-42a7-a2b4-69ba28aa7e09",
              "label": null,
              "isExecuted": false,
              "uuid": "941e87c9-433e-43a1-be29-05975107a99f"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Fetch and Create -> Update Pull Time",
              "targetStep": "/api/3/workflow_steps/02631bdf-5f8d-4fc4-b192-602356e202cc",
              "sourceStep": "/api/3/workflow_steps/966a046a-15d7-4c23-8764-9c2af2983c70",
              "label": null,
              "isExecuted": false,
              "uuid": "5bcb7573-2b63-445e-a898-9f595f76e76b"
            }
          ],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "0ecb3932-02e6-4826-bcb3-7aea1d493142",
          "recordTags": [
            "dataingestion",
            "ingest",
            "ibm-xforce-threat-intel-feed"
          ],
          "id": 77,
          "createUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "createDate": 1641280805.634763,
          "modifyUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "modifyDate": 1641280805.634763,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Collections",
          "aliasName": null,
          "tag": "#IBM X-Force Threat Intelligence Feed",
          "description": "Retrieves a list of public/private/shared collection resources to which the users have access from IBM X-Force Threat Intelligence Feed, based on the collection ID you have specified.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1639414759,
          "collection": "/api/3/workflow_collections/8af111af-220b-4492-82e4-4c6cdce6f667",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/d6313406-67b1-42f3-a729-ca0c33769c0d",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Get Collections",
              "description": null,
              "arguments": {
                "name": "IBM X-Force Threat Intelligence Feed",
                "config": "71d2f6e6-9b83-4834-aa6d-a527a53b3cc1",
                "params": {
                  "collectionID": "botnets"
                },
                "version": "1.0.0",
                "connector": "ibm-xforce-threat-intel-feed",
                "operation": "get_collections",
                "operationTitle": "Get Collections",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "status": null,
              "top": "120",
              "left": "180",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "2a10dff6-8a10-4863-a4f5-9b584d52bc27",
              "id": 299
            },
            {
              "@type": "WorkflowStep",
              "name": "Alerts",
              "description": null,
              "arguments": {
                "route": "2f736ba6-28cb-48c0-93ef-3d15bfad219f",
                "title": "IBM X-Force Threat Intelligence Feed: Get Collections",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "uuid": "d6313406-67b1-42f3-a729-ca0c33769c0d",
              "id": 300
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Alerts -> Get Collections",
              "targetStep": "/api/3/workflow_steps/2a10dff6-8a10-4863-a4f5-9b584d52bc27",
              "sourceStep": "/api/3/workflow_steps/d6313406-67b1-42f3-a729-ca0c33769c0d",
              "label": null,
              "isExecuted": false,
              "uuid": "ecd0cd64-21ac-40b6-88f5-cf1b2078b10f"
            }
          ],
          "priority": null,
          "uuid": "46fd448f-9945-4da7-bf99-49082b190c6b",
          "recordTags": [
            "IBM X-Force",
            "Threat Intelligence Feed"
          ],
          "id": 78,
          "createUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "createDate": 1641280805.640154,
          "modifyUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "modifyDate": 1641280805.640154,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get API Root Information",
          "aliasName": null,
          "tag": "#IBM X-Force Threat Intelligence Feed",
          "description": "Retrieves information containing title, description, TAXII versions, and maximum size of the content body for the specified TAXII server from IBM X-Force Threat Intelligence Feed.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1639414663,
          "collection": "/api/3/workflow_collections/8af111af-220b-4492-82e4-4c6cdce6f667",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/2a05462b-2c23-4f6e-9580-c144fc3e7b17",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Alerts",
              "description": null,
              "arguments": {
                "route": "9a4c7a45-37ad-44ea-8f33-08c0195a8775",
                "title": "IBM X-Force Threat Intelligence Feed: Get API Root Information",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "uuid": "2a05462b-2c23-4f6e-9580-c144fc3e7b17",
              "id": 301
            },
            {
              "@type": "WorkflowStep",
              "name": "Get API Root Information",
              "description": null,
              "arguments": {
                "name": "IBM X-Force Threat Intelligence Feed",
                "config": "''",
                "params": [],
                "version": "1.0.0",
                "connector": "ibm-xforce-threat-intel-feed",
                "operation": "get_api_root_information",
                "operationTitle": "Get API Root Information",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "status": null,
              "top": "120",
              "left": "188",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "3609b92b-82a3-456f-b332-754a2084f439",
              "id": 302
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Alerts -> Get API Root Information",
              "targetStep": "/api/3/workflow_steps/3609b92b-82a3-456f-b332-754a2084f439",
              "sourceStep": "/api/3/workflow_steps/2a05462b-2c23-4f6e-9580-c144fc3e7b17",
              "label": null,
              "isExecuted": false,
              "uuid": "78b8b227-7bff-421c-b95b-496358b9b324"
            }
          ],
          "priority": null,
          "uuid": "5b8639f2-78e1-4b36-9000-540260c75537",
          "recordTags": [
            "IBM X-Force",
            "Threat Intelligence Feed"
          ],
          "id": 79,
          "createUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "createDate": 1641280805.641849,
          "modifyUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "modifyDate": 1641280805.641849,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "> IBM X-Force Threat Intel > Fetch and Create",
          "aliasName": null,
          "tag": null,
          "description": "Fetch and Create Incidents from IBM X-Force Threat Intelligence Feed",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [
            "ingestedData"
          ],
          "synchronous": false,
          "lastModifyDate": 1641291779,
          "collection": "/api/3/workflow_collections/8af111af-220b-4492-82e4-4c6cdce6f667",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/bd0807dc-0381-46b6-b2d8-ca130e776522",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "step_variables": {
                  "input": {
                    "params": []
                  },
                  "_configuration_schema": "[\n  {\n    \"title\": \"Confidence\",\n    \"name\": \"confidence\",\n    \"type\": \"integer\",\n    \"tooltip\": \"Default Confidence score to be set for the feeds\",\n    \"required\": false,\n    \"editable\": true,\n    \"visible\": true,\n    \"value\": 50,\n    \"validation\": {\n       \"minlength\": 0,\n       \"maxlength\": 100\n    }\n  },\n  {\n    \"title\": \"Reputation\",\n    \"name\": \"reputation\",\n    \"type\": \"select\",\n    \"tooltip\": \"Default Reputation to be set for the feeds\",\n    \"required\": true,\n    \"editable\": true,\n    \"visible\": true,\n    \"options\": [\"Good\", \"Suspicious\", \"Malicious\", \"No Reputation Available\", \"TBD\"],\n    \"value\": \"Suspicious\"\n  },\n  {\n    \"title\": \"TLP\",\n    \"name\": \"tlp\",\n    \"type\": \"select\",\n    \"tooltip\": \"Default TLP to be set for the feeds\",\n    \"required\": false,\n    \"editable\": true,\n    \"visible\": true,\n    \"options\": [\"Red\", \"Amber\", \"Green\", \"White\"],\n    \"value\": \"White\"\n  },\n  {\n    \"title\": \"Maximum Age (in days)\",\n    \"name\": \"expiry\",\n    \"type\": \"integer\",\n    \"tooltip\": \"Default age for the feeds. The indicator expires on 'valid_until' date unless a different expiry is specified here. If specified, the indicator will be marked expired on valid_from + expiry.\",\n    \"required\": false,\n    \"editable\": true,\n    \"visible\": true\n  }\n]"
                }
              },
              "status": null,
              "top": "40",
              "left": "40",
              "stepType": "/api/3/workflow_step_types/b348f017-9a94-471f-87f8-ce88b6a7ad62",
              "uuid": "bd0807dc-0381-46b6-b2d8-ca130e776522",
              "id": 305
            },
            {
              "@type": "WorkflowStep",
              "name": "Resolve Range",
              "description": null,
              "arguments": {
                "tlp_resolved": "{{ vars.tlp | resolveRange(vars.tlp_map)}}",
                "reputation_resolved": "{{ vars.reputation | resolveRange(vars.reputation_map)"
              },
              "status": null,
              "top": "260",
              "left": "420",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "1feb9e5b-4c85-458c-92f1-403ef93f504e",
              "id": 303
            },
            {
              "@type": "WorkflowStep",
              "name": "Is Data Only For Mapping",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "option": "Yes, For Mapping",
                    "step_iri": "/api/3/workflow_steps/f6db7f8b-b22c-459c-b379-0c8e800539d2",
                    "condition": "{{ vars.request.env_setup == true }}",
                    "step_name": "Return Sample Data"
                  },
                  {
                    "option": "No, For Ingestion",
                    "default": true,
                    "step_iri": "/api/3/workflow_steps/0503a027-c925-4796-bd8d-5b4ea4c9f20a",
                    "step_name": "Create Record"
                  }
                ]
              },
              "status": null,
              "top": "380",
              "left": "600",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "uuid": "cc8946ba-60fc-4958-9199-866bb687b7e8",
              "id": 306
            },
            {
              "@type": "WorkflowStep",
              "name": "Return Sample Data",
              "description": null,
              "arguments": {
                "data": "[\n    {\n      \"id\": \"indicator--c51cf125-631b-4f7b-8478-c7120a01a432\",\n      \"type\": \"indicator\",\n      \"created\": \"2012-03-22T07:26:00.000Z\",\n      \"modified\": \"2021-12-27T22:02:00.000Z\",\n      \"labels\": [\n        \"malicious-activity\",\n        \"xfe-threat-score-7.1\"\n      ],\n      \"name\": \"IP Report for IP address 176.63.6.113\",\n      \"description\": \"Unauthorized access attempts originating from this IP address were detected.\",\n      \"pattern\": \"[ ipv4-addr:value = '176.63.6.113' ]\",\n      \"valid_from\": \"2021-12-27T22:02:00.000Z\"\n    },\n    {\n      \"id\": \"indicator--6d96b9ed-fff3-4192-8602-98a4ea729b0b\",\n      \"type\": \"indicator\",\n      \"created\": \"2012-03-22T07:26:00.000Z\",\n      \"modified\": \"2021-12-27T21:10:00.000Z\",\n      \"labels\": [\n        \"malicious-activity\",\n        \"xfe-threat-score-10\"\n      ],\n      \"name\": \"IP Report for IP address 77.168.147.173\",\n      \"description\": \"This IP was involved in spam sending activities.\",\n      \"pattern\": \"[ ipv4-addr:value = '77.168.147.173' ]\",\n      \"valid_from\": \"2021-12-27T21:10:00.000Z\"\n    },\n    {\n      \"id\": \"indicator--45a22043-4b10-441f-83ef-f2b35e054906\",\n      \"type\": \"indicator\",\n      \"created\": \"2012-03-14T20:59:00.000Z\",\n      \"modified\": \"2021-12-28T11:02:00.000Z\",\n      \"labels\": [\n        \"anomalous-activity\",\n        \"xfe-threat-score-5.7\"\n      ],\n      \"name\": \"IP Report for IP address 109.64.213.22\",\n      \"description\": \"Unauthorized access attempts originating from this IP address were detected.\",\n      \"pattern\": \"[ ipv4-addr:value = '109.64.213.22' ]\",\n      \"valid_from\": \"2021-12-28T11:02:00.000Z\"\n    },\n    {\n      \"id\": \"indicator--25140873-47a7-486a-882e-e347a6897112\",\n      \"type\": \"indicator\",\n      \"created\": \"2012-03-22T07:26:00.000Z\",\n      \"modified\": \"2021-12-27T07:52:00.000Z\",\n      \"labels\": [\n        \"malicious-activity\",\n        \"xfe-threat-score-10\"\n      ],\n      \"name\": \"IP Report for IP address 123.193.193.176\",\n      \"description\": \"One of the five RIRs announced a (new) location mapping of the IP.\",\n      \"pattern\": \"[ ipv4-addr:value = '123.193.193.176' ]\",\n      \"valid_from\": \"2021-12-27T07:52:00.000Z\"\n    },\n    {\n      \"id\": \"indicator--c1faa3a4-8d22-49fd-8a99-443fdc4a7dc2\",\n      \"type\": \"indicator\",\n      \"created\": \"2013-07-06T06:27:00.000Z\",\n      \"modified\": \"2021-12-27T07:52:00.000Z\",\n      \"labels\": [\n        \"malicious-activity\",\n        \"xfe-threat-score-7.1\"\n      ],\n      \"name\": \"IP Report for IP address 179.108.86.6\",\n      \"description\": \"One of the five RIRs announced a (new) location mapping of the IP.\",\n      \"pattern\": \"[ ipv4-addr:value = '179.108.86.6' ]\",\n      \"valid_from\": \"2021-12-27T07:52:00.000Z\"\n    },\n    {\n      \"id\": \"indicator--cd10b0d5-5446-47d1-8cdd-541fc37c7f6e\",\n      \"type\": \"indicator\",\n      \"created\": \"2014-11-11T14:00:00.000Z\",\n      \"modified\": \"2021-12-27T23:03:00.000Z\",\n      \"labels\": [\n        \"anomalous-activity\",\n        \"xfe-threat-score-5.7\"\n      ],\n      \"name\": \"IP Report for IP address 187.255.34.95\",\n      \"description\": \"Unauthorized access attempts originating from this IP address were detected.\",\n      \"pattern\": \"[ ipv4-addr:value = '187.255.34.95' ]\",\n      \"valid_from\": \"2021-12-27T23:03:00.000Z\"\n    }\n]"
              },
              "status": null,
              "top": "240",
              "left": "940",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "f6db7f8b-b22c-459c-b379-0c8e800539d2",
              "id": 307
            },
            {
              "@type": "WorkflowStep",
              "name": "Configuration",
              "description": null,
              "arguments": {
                "tlp": "Amber",
                "expiry": "90",
                "tlp_map": "{'Red': {{'TrafficLightProtocol'| picklist('Red') }}, 'Amber': {{'TrafficLightProtocol'| picklist('Amber') }}, 'Green': {{'TrafficLightProtocol'| picklist('Green') }}, 'White': {{'TrafficLightProtocol'| picklist('White') }}}",
                "confidence": 60,
                "reputation": "Suspicious",
                "reputation_map": "{'0..7': {{'IndicatorReputation'| picklist('Suspicious') }}, '7.1..10': {{'IndicatorReputation'| picklist('Malicious') }}}",
                "indicators_indicatorStatus_map": "{}",
                "indicators_typeofindicator_map": "{'domain-name-value': {{'IndicatorType'| picklist('Domain') }}, 'file-name': {{'IndicatorType'| picklist('File') }}, 'file-hashes.md5': {{'IndicatorType'| picklist('FileHash-MD5') }}, 'file-hashes.sha1': {{'IndicatorType'| picklist('FileHash-SHA1') }}, 'file-hashes.sha256': {{'IndicatorType'| picklist('FileHash-SHA256') }}, 'network-traffic, ipv4-addr-value, ipv6-addr-value': {{'IndicatorType'| picklist('IP Address') }}, 'windows-registry-key-key': {{'IndicatorType'| picklist('Registry') }}, 'process-name': {{'IndicatorType'| picklist('Process') }}, 'url-value': {{'IndicatorType'| picklist('URL') }}}"
              },
              "status": null,
              "top": "160",
              "left": "240",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "7702aa78-b960-4e2e-a785-cfa5f53ba971",
              "id": 304
            },
            {
              "@type": "WorkflowStep",
              "name": "Create Record",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.input.params.ingestedData}}",
                  "__bulk": true,
                  "parallel": false,
                  "condition": "",
                  "batch_size": 1000
                },
                "resource": {
                  "tLP": "{{vars.tlp_resolved}}",
                  "label": "{{ vars.item.label }}",
                  "value": "{%if ':value' in vars.item.pattern %}{{ vars.item.pattern.split(\":value = \")[-1].split(\"]\")[0].strip()[1:-1] }}{% elif 'network-traffic' in vars.item.pattern %}{{ vars.item.pattern.split(\"network-traffic:src_ref.value =\")[-1].split(\"]\")[0].strip()[1:-1] + \":\" + vars.item.pattern.split(\"network-traffic:src_port =\")[1].split(\"AND\")[0].strip()}}{% else %}{{vars.item.pattern}}{% endif %}",
                  "source": "IBM X-Force",
                  "created": "{% if vars.item.created %}{{arrow.get(vars.item.created).int_timestamp}}{% endif %}",
                  "pattern": "{{ vars.item.pattern }}",
                  "modified": "{% if vars.item.modified %}{{arrow.get(vars.item.modified).int_timestamp}}{% endif %}",
                  "sourceId": "{{ vars.item.id }}",
                  "__replace": "true",
                  "validFrom": "{% if vars.item.valid_from %}{{arrow.get(vars.item.valid_from).int_timestamp}}{% endif %}",
                  "confidence": "{% if vars.confidence %}{{ vars.confidence }}{% endif %}",
                  "reputation": "{% if vars.item.labels[1] %}{{vars.item.labels[1] | resolveRange(vars.reputation_map)}}{% else %}{{vars.reputation_resolved}}{% endif %}",
                  "sourceData": "{{ vars.item | toJSON}}",
                  "typeOfFeed": "{% if 'pattern' in vars.item %}{{ vars.item.pattern.split(\\\":\\\")[0][1:] | resolveRange(vars.threat_intelligence_typeofindicator_map)}}{% endif %}",
                  "validUntil": "{% if vars.expiry %}{{ arrow.get(vars.item.valid_from).int_timestamp + (vars.expiry | int)*24*60*60 }}{% else %}{{arrow.get(vars.item.valid_until).int_timestamp}}{% endif %}",
                  "description": "<p>{{ vars.item.description }}</p>"
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "/api/3/upsert/threat_intel_feeds",
                "__recommend": [],
                "fieldOperation": {
                  "recordTags": "Overwrite"
                },
                "step_variables": []
              },
              "status": null,
              "top": "500",
              "left": "940",
              "stepType": "/api/3/workflow_step_types/2597053c-e718-44b4-8394-4d40fe26d357",
              "uuid": "0503a027-c925-4796-bd8d-5b4ea4c9f20a",
              "id": 308
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Resolve Range -> Is Data Only For Mapping",
              "targetStep": "/api/3/workflow_steps/cc8946ba-60fc-4958-9199-866bb687b7e8",
              "sourceStep": "/api/3/workflow_steps/1feb9e5b-4c85-458c-92f1-403ef93f504e",
              "label": null,
              "isExecuted": false,
              "uuid": "07cc35a7-124a-42db-908f-96d47591bab4"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Is data only for mapping -> Return Sample Data",
              "targetStep": "/api/3/workflow_steps/f6db7f8b-b22c-459c-b379-0c8e800539d2",
              "sourceStep": "/api/3/workflow_steps/cc8946ba-60fc-4958-9199-866bb687b7e8",
              "label": "Yes, For Mapping",
              "isExecuted": false,
              "uuid": "965f91ab-631f-4cad-bdcc-4938a41aaac7"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Configuration",
              "targetStep": "/api/3/workflow_steps/7702aa78-b960-4e2e-a785-cfa5f53ba971",
              "sourceStep": "/api/3/workflow_steps/bd0807dc-0381-46b6-b2d8-ca130e776522",
              "label": null,
              "isExecuted": false,
              "uuid": "a4e064ad-ce0a-480d-917a-a8c9b35dc31d"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Configuration -> Resolve Range",
              "targetStep": "/api/3/workflow_steps/1feb9e5b-4c85-458c-92f1-403ef93f504e",
              "sourceStep": "/api/3/workflow_steps/7702aa78-b960-4e2e-a785-cfa5f53ba971",
              "label": null,
              "isExecuted": false,
              "uuid": "bac2d6a7-c7b3-4554-bead-df2cb628f223"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Is Data Only For Mapping -> Create Record",
              "targetStep": "/api/3/workflow_steps/0503a027-c925-4796-bd8d-5b4ea4c9f20a",
              "sourceStep": "/api/3/workflow_steps/cc8946ba-60fc-4958-9199-866bb687b7e8",
              "label": "No, For Ingestion",
              "isExecuted": false,
              "uuid": "3b4bc7b2-6cf1-4adf-8cfb-a1ab0a3ee371"
            }
          ],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "6528e062-5a91-496b-acce-433f67726367",
          "recordTags": [
            "dataingestion",
            "create",
            "fetch",
            "ibm-xforce-threat-intel-feed"
          ],
          "id": 80,
          "createUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "createDate": 1641280805.643604,
          "modifyUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "modifyDate": 1641291778.916944,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Objects By Collection ID",
          "aliasName": null,
          "tag": "#IBM X-Force Threat Intelligence Feed",
          "description": "Retrieves all available objects from a collection to which the users have access from IBM X-Force Threat Intelligence Feed, based on the collection ID and other input parameters you have specified.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1639416104,
          "collection": "/api/3/workflow_collections/8af111af-220b-4492-82e4-4c6cdce6f667",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/e23fc754-091e-4067-ba68-aa743a8a6426",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Get Objects By Collection ID",
              "description": null,
              "arguments": {
                "name": "IBM X-Force Threat Intelligence Feed",
                "config": "71d2f6e6-9b83-4834-aa6d-a527a53b3cc1",
                "params": {
                  "filename": "feed.json",
                  "added_after": "",
                  "added_before": "",
                  "collectionID": "guid:f26ebe1c3bd7992039b53bb8c553d7ca",
                  "file_response": true
                },
                "version": "1.0.0",
                "connector": "ibm-xforce-threat-intel-feed",
                "operation": "get_objects_by_collection_id",
                "operationTitle": "Get Objects By Collection ID",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "status": null,
              "top": "120",
              "left": "180",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "163fb4a4-d072-4124-8abd-3d5dbc69a916",
              "id": 309
            },
            {
              "@type": "WorkflowStep",
              "name": "Create Attachment",
              "description": null,
              "arguments": {
                "params": {
                  "name": "my_demo_attachment",
                  "filename": "{{vars.steps.Get_Objects_By_Collection_ID.data.filename}}",
                  "description": "",
                  "request_headers": "",
                  "multipart_headers": "",
                  "extra_multipart_fields": ""
                },
                "version": "3.1.2",
                "connector": "cyops_utilities",
                "operation": "create_cyops_attachment",
                "operationTitle": "File: Create Attachment from File",
                "step_variables": []
              },
              "status": null,
              "top": "220",
              "left": "380",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "8d8dc31a-48bf-4a17-93ff-38c77a99706d",
              "id": 310
            },
            {
              "@type": "WorkflowStep",
              "name": "Alerts",
              "description": null,
              "arguments": {
                "route": "d9b8e549-3ec5-4b96-883e-4f82d3d3ad4c",
                "title": "IBM X-Force Threat Intelligence Feed: Get Objects By Collection ID",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "uuid": "e23fc754-091e-4067-ba68-aa743a8a6426",
              "id": 311
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Alerts -> Get Objects By Collection ID",
              "targetStep": "/api/3/workflow_steps/163fb4a4-d072-4124-8abd-3d5dbc69a916",
              "sourceStep": "/api/3/workflow_steps/e23fc754-091e-4067-ba68-aa743a8a6426",
              "label": null,
              "isExecuted": false,
              "uuid": "69d7e0e6-0d5d-470d-ba48-74976a8bf4df"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get Objects By Collection ID -> Create Attachment",
              "targetStep": "/api/3/workflow_steps/8d8dc31a-48bf-4a17-93ff-38c77a99706d",
              "sourceStep": "/api/3/workflow_steps/163fb4a4-d072-4124-8abd-3d5dbc69a916",
              "label": null,
              "isExecuted": false,
              "uuid": "b252ac97-5b7d-4ea9-bd80-b7616ddf4d7e"
            }
          ],
          "priority": null,
          "uuid": "886e6de5-eb55-419a-836b-f074cc34c3e1",
          "recordTags": [
            "IBM X-Force",
            "Threat Intelligence Feed"
          ],
          "id": 81,
          "createUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "createDate": 1641280805.646262,
          "modifyUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "modifyDate": 1641280805.646262,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Manifest By Collection ID",
          "aliasName": null,
          "tag": "#IBM X-Force Threat Intelligence Feed",
          "description": "Retrieves manifest information about all available objects to which the users have access from IBM X-Force Threat Intelligence Feed, based on the collection ID and other input parameters you have specified.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1639415518,
          "collection": "/api/3/workflow_collections/8af111af-220b-4492-82e4-4c6cdce6f667",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/434c0ae4-4a5d-4f06-9dee-7a391e62ff94",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Alerts",
              "description": null,
              "arguments": {
                "route": "10e1addb-4885-472b-b7e5-173a0fb67d9b",
                "title": "IBM X-Force Threat Intelligence Feed: Get Manifest By Collection ID",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "uuid": "434c0ae4-4a5d-4f06-9dee-7a391e62ff94",
              "id": 312
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Manifest By Collection ID",
              "description": null,
              "arguments": {
                "name": "IBM X-Force Threat Intelligence Feed",
                "config": "71d2f6e6-9b83-4834-aa6d-a527a53b3cc1",
                "params": {
                  "added_after": "",
                  "added_before": "",
                  "collectionID": "guid:d2410521b6017720270af3299b051ee8"
                },
                "version": "1.0.0",
                "connector": "ibm-xforce-threat-intel-feed",
                "operation": "get_manifest_by_collection_id",
                "operationTitle": "Get Manifest By Collection ID",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "status": null,
              "top": "120",
              "left": "180",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "60203354-ffcd-4b09-8dfc-b44a83d9caa3",
              "id": 313
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Alerts -> Get Manifest By Collection ID",
              "targetStep": "/api/3/workflow_steps/60203354-ffcd-4b09-8dfc-b44a83d9caa3",
              "sourceStep": "/api/3/workflow_steps/434c0ae4-4a5d-4f06-9dee-7a391e62ff94",
              "label": null,
              "isExecuted": false,
              "uuid": "bc94fbd6-ad95-4899-bb5a-0a8a0a0a59ee"
            }
          ],
          "priority": null,
          "uuid": "892d44c3-6465-469f-8306-91ee2707eb5f",
          "recordTags": [
            "IBM X-Force",
            "Threat Intelligence Feed"
          ],
          "id": 82,
          "createUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "createDate": 1641280805.647202,
          "modifyUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "modifyDate": 1641280805.647202,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Object By Object ID",
          "aliasName": null,
          "tag": "#IBM X-Force Threat Intelligence Feed",
          "description": "Retrieves general information for a specific object of a specific collection from IBM X-Force Threat Intelligence Feed, based on the collection ID and object ID you have specified.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1639415972,
          "collection": "/api/3/workflow_collections/8af111af-220b-4492-82e4-4c6cdce6f667",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/7af78a24-10a8-4cfa-a824-1460b7e38725",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Alerts",
              "description": null,
              "arguments": {
                "route": "35e826d9-0821-4e3c-911b-98a5e5711b97",
                "title": "IBM X-Force Threat Intelligence Feed: Get Object By Object ID",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "uuid": "7af78a24-10a8-4cfa-a824-1460b7e38725",
              "id": 314
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Object By Object ID",
              "description": null,
              "arguments": {
                "name": "IBM X-Force Threat Intelligence Feed",
                "config": "71d2f6e6-9b83-4834-aa6d-a527a53b3cc1",
                "params": {
                  "objectID": "report--37fc5eb8-f09f-40b9-a5c5-5432fa992fdd",
                  "collectionID": "guid:f26ebe1c3bd7992039b53bb8c553d7ca"
                },
                "version": "1.0.0",
                "connector": "ibm-xforce-threat-intel-feed",
                "operation": "get_objects_by_object_id",
                "operationTitle": "Get Object By Object ID",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "status": null,
              "top": "120",
              "left": "180",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "a4ff6453-cc49-456e-bf30-6710958bd15a",
              "id": 315
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Alerts -> Get Object By Object ID",
              "targetStep": "/api/3/workflow_steps/a4ff6453-cc49-456e-bf30-6710958bd15a",
              "sourceStep": "/api/3/workflow_steps/7af78a24-10a8-4cfa-a824-1460b7e38725",
              "label": null,
              "isExecuted": false,
              "uuid": "a17c5e22-3eb1-4100-a55e-dada7dfa60be"
            }
          ],
          "priority": null,
          "uuid": "c9e9dee6-97c3-4dff-bcf8-9136b4a43f9c",
          "recordTags": [
            "IBM X-Force",
            "Threat Intelligence Feed"
          ],
          "id": 83,
          "createUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "createDate": 1641280805.647995,
          "modifyUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "modifyDate": 1641280805.647995,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null
        }
      ]
    }
  ],
  "exported_tags": [
    "dataingestion",
    "ingest",
    "ibm-xforce-threat-intel-feed",
    "IBM X-Force",
    "Threat Intelligence Feed",
    "create",
    "fetch"
  ]
}